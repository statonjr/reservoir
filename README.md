# Reservoir

Reservoir provides you with a simple API for data persistence allowing
you to delay the choice of database without delaying your development.

There are a few guiding principles for Reservoir:

- key/value store. All Reservoir implementations, even for relational
databases, conform to the simple key/value store API.
- values are hashes. Every 'value' that goes in or out of a Reservoir
datastore is a hash.
- :key and :kind. Every 'value' must have a :kind entry; a short string
like "user" or "product". Persisted 'value's will have a :key entry;
strings generated by the datastore.
- Search with data. All searches are described by data.

## Usage

### Saving a value:

```ruby
repo.save({:kind => :dealership, :name => 'Hendrick BMW'})
# => {:kind => "dealership", :name => "Hendrick BMW", :key => "dealership-abc-123", :created => 20130201000000}
```

### Updating a value:

"Updating" creates a new value with a newer timestamp

```ruby
repo.save({:kind => :dealership, :key => 'dealership-abc-123', :name => "Hendrick BMW Northlake"})
# => {:kind => "dealership", :name => "Hendrick BMW Northlake", :key => "dealership-abc-123", :created => 20130209000000}
```

### Loading a value:

TODO: Add filters, sorts, and limit

```ruby
# If you have a key
repo.find_by_key('dealership-abc-123')
# => {:kind => "dealership", :name => "Hendrick BMW Northlake", :key => "dealership-abc-123", :created => 20130209000000}

# Else
repo.find_by_kind(:dealership) # returns all records with kind of dealership
```

### Deleting a value:

Values never get deleted, only marked as deleted.

```ruby
repo.delete_by_key('abc123')
# => {:kind => "dealership", :name => "Hendrick BMW Northlake", :key => "deleted-abc-123", :created => 20130209000000, :deleted => true}

repo.delete_by_kind(:dealership) # delete all dealerships
```

## Installation

Add this line to your application's Gemfile:

    gem 'reservoir'

And then execute:

    $ bundle

Or install it yourself as:

    $ gem install reservoir

## Contributing

1. Fork it
2. Create your feature branch (`git checkout -b my-new-feature`)
3. Commit your changes (`git commit -am 'Add some feature'`)
4. Push to the branch (`git push origin my-new-feature`)
5. Create new Pull Request
